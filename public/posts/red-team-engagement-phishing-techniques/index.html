<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<title>
  
     Red Team Engagement: Phishing Techniques | 
    SUAM
  
</title><meta name="description" content="สรุปเทคนิค Phishing สำหรับการทำ Red Team Engagement"><meta name="author" content="P">

<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/favicon-32x32.png " sizes="32x32" type="image/png">
<link rel="icon" href="/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#0c344b">
<link rel="icon" href="/favicon.ico">


<script async src="https://www.googletagmanager.com/gtag/js?id=UA-173363806-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-173363806-1');
</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/themes/prism.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<link rel="stylesheet" href="/dist/main.min.css"><link rel="canonical" href="https://suam.wtf/posts/red-team-engagement-phishing-techniques/"><meta property="og:title" content="Red Team Engagement: Phishing Techniques" />
<meta property="og:description" content="สรุปเทคนิค Phishing สำหรับการทำ Red Team Engagement" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suam.wtf/posts/red-team-engagement-phishing-techniques/" /><meta property="og:image" content="https://i.imgur.com/5FCon4F.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-07-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-06T00:00:00+00:00" />

<meta itemprop="name" content="Red Team Engagement: Phishing Techniques">
<meta itemprop="description" content="สรุปเทคนิค Phishing สำหรับการทำ Red Team Engagement"><meta itemprop="datePublished" content="2020-07-06T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-07-06T00:00:00+00:00" />
<meta itemprop="wordCount" content="255"><meta itemprop="image" content="https://i.imgur.com/5FCon4F.png">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://i.imgur.com/5FCon4F.png"/>

<meta name="twitter:title" content="Red Team Engagement: Phishing Techniques"/>
<meta name="twitter:description" content="สรุปเทคนิค Phishing สำหรับการทำ Red Team Engagement"/>

</head>
<body>
    
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://suam.wtf/">SUAM</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                
                    <li class="nav-item"><a class="nav-link" href="/">Home</a></li>
                
                    <li class="nav-item"><a class="nav-link" href="/about">About</a></li>
                
            
                <li class="nav-item">
                    <a href="https://webring.wonderful.software#suam.wtf" title="วงแหวนเว็บ" target="_blank" class="nav-link" rel="noopener">
                        <img src="/images/webring.black.svg" width="25px" height="25px" alt="วงแหวนเว็บ" />
                    </a>
                </li>
            </ul>
        </div>
    </div>
</nav>


    
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="meta text-muted mb-3">
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">July 6, 2020</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>255 words</span>
                            <span><i class="fas fa-clock mr-2"></i>2 mins read</span>
                        </div>

                        <h1>Red Team Engagement: Phishing Techniques</h1>

                        <ul class="authors list-inline"><li class="list-inline-item mr-3">
                    <div class="media author"><a href="/authors/p/" class="mr-3">
                                    <picture>
                                        <source srcset="/authors/p/P_hubca513c3c2609d784129785a8d5eb910_53194_64x0_resize_q75_box.jpg 1x, /authors/p/P_hubca513c3c2609d784129785a8d5eb910_53194_128x0_resize_q100_box.jpg 2x, /authors/p/P_hubca513c3c2609d784129785a8d5eb910_53194_192x0_resize_q100_box.jpg 3x">
                                        <img src="/authors/p/P_hubca513c3c2609d784129785a8d5eb910_53194_64x0_resize_q75_box.jpg" class="rounded-circle" alt="P">
                                    </picture>
                                </a><div class="media-body">
                            <h5 class="name my-0"><a href="/authors/p/" class="small">P</a>
                            </h5><p class="social small text-muted">
                                    <a href="https://twitter.com/@pe3zx">@pe3zx</a>
                                </p></div>
                    </div>
                </li></ul>
                    </div>
                </div><div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="content">
                            <p><img src="https://i.imgur.com/5FCon4F.png" alt="cover"></p>
<p>โพสต์นี้เป็นอีกโพสต์หนึ่งซึ่งผมจะใช้มันเป็นโน้ตสั้น ๆ สำหรับทดสิ่งที่ได้รู้มาเผื่อซักวันนึงเราจะได้ใช้มันและก็หวังว่าคนอื่นจะได้รับประโยชน์เช่นกัน สำหรับเนื้อหาที่เราจะเลือก<em>ทด</em>กันในวันนี้มาจาก SANS@MIC Webcast ในหัวข้อ <strong>Catch and release: phishing techniques for the good guys</strong> โดย Jan Kopřiva ครับ</p>
<blockquote>
<p>ดาวโหลดสไลด์ประกอบการบรรยายหรือดู Webcast เต็มย้อนหลังได้ที่ <a href="https://www.sans.org/webcasts/sansatmic-catch-release-phishing-techniques-good-guys-115430">SANS Webcast</a></p>
</blockquote>
<ul>
<li>คีย์เวิร์ดสำคัญในการทำ content ของ phishing operation ให้มีโอกาสสำเร็จสูงคือ<strong>การเล่นกับคน</strong>ผ่านปัจจัยซึ่งทำให้การวิเคราะห์และตัดสินใจด้วยเหตุและผลถูกบั่นทอนลง ปัจจัยเหล่านั้นมีได้หลากหลาย แต่ในการบรรยายนี้จะเน้นไปที่ปัจจัยอยู่ 3 ลักษณะคือ <strong>Known</strong>, <strong>Trustoworthy</strong> และ <strong>Urgent</strong> ทั้ง 3 ปัจจัยนี้หากใช้อย่างถูกต้องก็จะสามารถช่วยเพิ่มอัตราความสำเร็จได้เป็นอย่างดี</li>
<li>ขั้นตอนการ Recon ยังคงเป็นขั้นตอนที่สำคัญเพื่อให้รู้ Defensive mechanism ที่เป้าหมายมี อาทิ ผู้ให้บริการอีเมลของเป้าหมาย<em>น่าจะ</em>มีความสามารถในการตรวจจับและป้องกันอีเมลปลอมได้ดีแค่ไหน หรือในฝั่งของเป้าหมายเองมีการตั้งค่า SPF/DKIM/DMARC ไว้อย่างไรเพื่อป้องการโจมตีในลักษณะนี้</li>
<li>เทคโนโลยีอย่าง SPF/DKIM/DMARC เป็นเทคโนโลยีซึ่งบางครั้งการเอามาใช้ให้ถูกต้องก็เป็นเรื่องที่ยาก ดังนั้นการนำผลลัพธ์จากการ Recon มาดูอาจช่วยให้เราพบอะไรที่น่าสนใจ และนำไปสู่การ bypass การป้องกันได้ ตัวอย่าง <a href="https://hackerone.com/reports/56742">#56742 SPF whitelist of mandrill leads to email forgery</a></li>
<li>เทคนิคการเล่นกับชื่อผู้ส่ง
<ul>
<li>ปลอมทั้งหมดผ่าน SMTP server ของเราเองแต่อาจเจอปัญหาในการตรวจสอบย้อนกลับ หรือปัญหาเกี่ยวกับ reputation ของ SMTP server</li>
<li>ใช้ทริคปลอมอีเมลแอดเดรส เช่น ระบุ Sender address ให้มี <code>First Last &lt;fake@emai-address.com&gt;</code> ไปด้วย</li>
</ul>
</li>
<li>เทคนิคการเล่นกับลิงค์ทั้งลิงค์ของ SMTP server หรือในเนื้อหาของอีเมล
<ul>
<li>ใช้เทคนิค Character substituion โดยอาจลองหาผ่าน <a href="https://github.com/elceef/dnstwist">elceef/dnstwist</a></li>
<li>ใช้เทคนิค IDN homograph โดยใช้ <a href="https://www.irongeek.com/homoglyph-attack-generator.php">Homoglyph Attack Generator</a> ช่วยสร้าง</li>
<li>ใช้เทคนิค multi-level domain name เช่น <a href="https://www.vice.com/en_us/article/mg7xjb/how-hackers-broke-into-john-podesta-and-colin-powells-gmail-accounts">ตัวอย่างในเคสของ DNC hack ตอนปี 2016</a></li>
<li>ใช้เทคนิค Open redirect ให้ลิงค์ที่ไปยังเว็บไซต์ปลอมผ่านเว็บไซต์ที่น่าเชื่อถือก่อน</li>
<li>ใช้การใส่ attribute <code>title</code> ในแท็ก <code>&lt;a&gt;</code> กับเป้าหมายที่ใช้เว็บอีเมลเป็นไคล์เอนต์หลัก เช่น <code>&lt;a href=&quot;https://fake.com&gt;&quot; title=&quot;https://godd.com&quot;&gt;link&lt;/a&gt;</code></li>
</ul>
</li>
<li>เทคนิคการเล่นกับเนื้อหาของอีเมล
<ul>
<li>หลีกเลี่ยงการใช้คีย์เวิร์ดยอดนิยมที่อาจถูกระบบตรวจจับแบบ keyword matching ตรวจเจอ เช่น Microsoft, Account, Urgent, Invoice</li>
<li>ใช้เทคนิค <a href="https://www.avanan.com/blog/zwasp-microsoft-office-365-phishing-vulnerability">Z-WASP</a> ในการช่วยแตกคำเพื่อป้องกันการตรวจจับ</li>
<li>ใช้เทคนิค <a href="https://blog.knowbe4.com/the-ropemaker-email-exploit-can-change-an-already-delivered-email">Ropemaker</a> ซึ่งมีการนำโค้ด CSS มาใช้ในการเปลี่ยนหน้าตาเนื้อหาเมื่ออีเมลถูกเปิดอ่าน</li>
<li>ใช้เทคนิค Zerofont หรือการแทรกตัวอักษรขนาดเล็กระหว่างคำที่มักจะถูกตรวจจับโดยระบบ</li>
</ul>
</li>
</ul>
<p>อัปเดตเทคนิคเพิ่มเติมจากประสบการณ์การทำ Phishing simulation</p>
<ul>
<li>พิจารณาการใช้บริการอย่าง Mailchip หรือ Sendgrid ในการช่วยส่งอีเมลเนื่องจาก reputation ที่ดีกว่า</li>
<li>ตั้งค่า <code>Return-Path</code> ให้ตรงกับอีเมลเป้าหมายเพื่อกำหนดปลายทางหากเกิดกรณี email bouncing</li>
<li>พิจารณาการตั้งค่าหรือเปลี่ยน A record ใน DNS หรือตั้ง TTL ให้ต่ำหลังจากมีการส่งอีเมลออกไปแล้ว เนื่องบริการอีเมลบางบริการจะมีการตรวจสอบอีเมลหลังจากที่มีการส่งออกไปและจะพบปัญหาในการตรวจสอบ ซึ่งอาจช่วยให้สามารถข้ามผ่านกระบวนการตรวจสอบได้</li>
<li>หากเป็นไปได้ควรหลีกเลี่ยงลักษณะของเนื้อหาที่สามารถถูกตรวจสอบได้ด้วยวิธีการ pattern matching เช่น HTML หรือ text ทั่วไป และควรระมัดระวังเป็นอย่างยิ่งหากมีการใช้ payload ที่เป็นนิยม เช่น ไฟล์เอกสารแนบมาโครสคริปต์</li>
<li>หากต้องมีการใส่ไฟล์แนบ วิธีการปลอดภัยที่สุดคือการอัปโหลดไฟล์แนบดังกล่าวไปยังบริการฝากไฟล์ที่มีความน่าเชื่อถือสูง หรือในระบบที่เราสามารถควบคุมได้ เพื่อลดความเสี่ยงในการที่จะถูกดึงไฟล์แนบออกไปตรวจสอบ</li>
<li>ทำการปรับเปลี่ยนคำใน payload เพื่อป้องกันการทำ pattern matching ตัวอย่างเช่น หาก payload มีการใช้คำว่า <code>powershell.exe</code> เราอาจสามารถใช้สคริปต์อย่าง <a href="https://github.com/danielbohannon/Invoke-Obfuscation">Invoke-Obfuscation</a> มาช่วยในการปกปิด ให้ได้ผลลัพธ์ที่ไม่สามารถตรวจจับได้ทันที เช่น <code>&quot;po&quot; &amp; &quot;w&quot; &amp; &quot;er&quot; &amp; &quot;s&quot; &amp; &quot;he&quot; &amp; &quot;l&quot; &amp; &quot;l&quot; &amp; &quot;.e&quot; &amp; &quot;x&quot; &amp; &quot;e&quot; &amp; &quot; &quot;</code></li>
<li>ต้องตรวจสอบการเข้าถึงหน้าเว็บไซต์ปลอมเสมอ และใช้วิธีการ เช่น <code>&lt;meta&gt;</code> ในการเปลี่ยนเส้นทางความพยายามเข้าถึงที่ไม่ถูกต้องออก</li>
</ul>
<p>แหล่งข้อมูลเพิ่มเติม:</p>
<ul>
<li><a href="https://blog.sublimesecurity.com/red-team-techniques-gaining-access-on-an-external-engagement-through-spear-phishing/">Red Team Techniques: Gaining access on an external engagement through spear-phishing</a></li>
<li><a href="https://www.avanan.com/blog/metamorph-html-obfuscation-phishing-attack">MetaMorph HTML Obfuscation Phishing Attack</a></li>
</ul>

                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        
                    </div>
                </div></article>
        </div>
    </div>

    
</main>


    <footer class="footer text-center bg-dark py-2">
    <div class="container">
        <div class="row">
            <div class="col">
                <ul class="list-inline">
                    
                </ul>

                <p class="text-muted">
                    
                        Copyright &copy; SUAM 2022
                    
                </p>

                <p class="text-muted">
                Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with <a href="https://github.com/puresyntax71/hugo-theme-chunky-poster" target="_blank">Chunky Poster</a>.
                </p>
            </div>
        </div>
    </div>
</footer>

    
    
        
            <script src="/dist/app.js"></script>
        
    
        
            <script src="/dist/lazyload.js"></script>
        
    
        
            <script src="/dist/main.js"></script>
        
    
        
            <script src="/dist/vendors~app.js"></script>
        
    
        
            <script src="/dist/vendors~app~bootstrap.js"></script>
        
    
        
            <script src="/dist/vendors~bootstrap.js"></script>
        
    
        
            <script src="/dist/vendors~ekkoLightbox.js"></script>
        
    



<script>
    window.Prism = window.Prism || {};
    window.Prism.manual = true;
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>



<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"></script>
<script>
document.body.onload = () => {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\[", right: "\\]", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\(", right: "\\)", display: false}
        ]
    });
};
</script>






    
</body>
</html>
